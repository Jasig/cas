<?xml version="1.0" encoding="UTF-8"?>

<beans xmlns="http://www.springframework.org/schema/beans"
       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
       xmlns:p="http://www.springframework.org/schema/p"
       xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.1.xsd">

  <bean id="passwordPolicyAction" class="org.jasig.cas.web.flow.PasswordPolicyEnforcementAction">
    <property name="passwordPolicyEnforcer" ref="ldapPasswordPolicyEnforcer" />
    <property name="passwordPolicyUrl" value="${ldap.authentication.lppe.password.url}" />
  </bean>

  <bean id="ldapPasswordPolicyEnforcer" class="org.jasig.cas.adaptors.ldap.LdapPasswordPolicyEnforcer">
    <property name="searchBase" value="${ldap.authentication.basedn}" />
    <property name="contextSource" ref="contextSource" />
    <property name="filter" value="${ldap.authentication.filter}" />
    <property name="ignorePartialResultException" value="${ldap.authentication.ignorePartialResultException}" />
    <property name="warnAll" value="${ldap.authentication.lppe.warnAll}" />
    <property name="dateFormat" value="${ldap.authentication.lppe.dateFormat}" />
    <property name="dateAttribute" value="${ldap.authentication.lppe.dateAttribute}" />
    <property name="warningDaysAttribute" value="${ldap.authentication.lppe.warningDaysAttribute}" />
    <property name="validDaysAttribute" value="${ldap.authentication.lppe.validDaysAttribute}" />
    <property name="warningDays" value="${ldap.authentication.lppe.warningDays}" />
    <property name="validDays" value="${ldap.authentication.lppe.validDays}" />
    <property name="noWarnAttribute" value="${ldap.authentication.lppe.noWarnAttribute}" />
    <property name="noWarnValues" value="${ldap.authentication.lppe.noWarnValues}" />
    <property name="enabled" value="${ldap.authentication.lppe.enabled}" />
  </bean>

</beans>
